<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Final - Syst√®me de Th√®me Global</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/theme-enhanced.css">
    <style>
        .test-container {
            padding: 2rem;
            margin: 1rem 0;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .test-success {
            background-color: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }
        .test-error {
            background-color: #f8d7da;
            border-color: #f5c6cb;
            color: #721c24;
        }
        .theme-preview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }
        .color-box {
            width: 100%;
            height: 60px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
    </style>
</head>
<body>
    <div class="container-fluid py-5">
        <div class="container">
            <h1 class="text-center mb-5">üé® Test Final - Syst√®me de Th√®me Global</h1>
            
            <!-- Test 1: V√©rification de l'initialisation -->
            <div class="test-container" id="test1">
                <h3>Test 1: Initialisation des Variables Globales</h3>
                <div id="test1-result"></div>
            </div>

            <!-- Test 2: V√©rification du th√®me -->
            <div class="test-container" id="test2">
                <h3>Test 2: Configuration du Th√®me</h3>
                <div id="test2-result"></div>
                <div class="theme-preview" id="theme-preview"></div>
            </div>

            <!-- Test 3: Fonctions utilitaires -->
            <div class="test-container" id="test3">
                <h3>Test 3: Fonctions Utilitaires du Th√®me</h3>
                <div id="test3-result"></div>
            </div>

            <!-- Test 4: Navigation et langues -->
            <div class="test-container" id="test4">
                <h3>Test 4: Navigation et Multilangue</h3>
                <div id="test4-result"></div>
            </div>

            <!-- Test 5: Donn√©es du site -->
            <div class="test-container" id="test5">
                <h3>Test 5: Donn√©es du Site</h3>
                <div id="test5-result"></div>
            </div>

            <!-- R√©sum√© des tests -->
            <div class="test-container mt-5" id="summary">
                <h3>üìä R√©sum√© des Tests</h3>
                <div id="summary-result"></div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/globalData.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ D√©but des tests du syst√®me de th√®me global');
            
            let testResults = [];

            // Test 1: V√©rification de l'initialisation
            function test1() {
                console.log('Test 1: V√©rification de l\'initialisation');
                const container = document.getElementById('test1');
                const result = document.getElementById('test1-result');
                
                try {
                    // V√©rifier que window.globalData existe
                    if (!window.globalData) {
                        throw new Error('window.globalData n\'existe pas');
                    }
                    
                    // V√©rifier les sections principales
                    const requiredSections = ['site', 'languages', 'navigation', 'theme'];
                    const missingSections = requiredSections.filter(section => !window.globalData[section]);
                    
                    if (missingSections.length > 0) {
                        throw new Error(`Sections manquantes: ${missingSections.join(', ')}`);
                    }
                    
                    // V√©rifier les fonctions globales
                    const requiredFunctions = ['getGlobalData', 'getTheme', 'getThemeColor', 'getCurrentLanguage'];
                    const missingFunctions = requiredFunctions.filter(func => typeof window[func] !== 'function');
                    
                    if (missingFunctions.length > 0) {
                        throw new Error(`Fonctions manquantes: ${missingFunctions.join(', ')}`);
                    }
                    
                    result.innerHTML = `
                        <div class="alert alert-success">
                            ‚úÖ <strong>Test r√©ussi!</strong><br>
                            - GlobalData initialis√©<br>
                            - ${requiredSections.length} sections trouv√©es<br>
                            - ${requiredFunctions.length} fonctions disponibles
                        </div>
                    `;
                    container.classList.add('test-success');
                    testResults.push(true);
                } catch (error) {
                    result.innerHTML = `
                        <div class="alert alert-danger">
                            ‚ùå <strong>Test √©chou√©:</strong><br>
                            ${error.message}
                        </div>
                    `;
                    container.classList.add('test-error');
                    testResults.push(false);
                }
            }

            // Test 2: V√©rification du th√®me
            function test2() {
                console.log('Test 2: V√©rification du th√®me');
                const container = document.getElementById('test2');
                const result = document.getElementById('test2-result');
                const preview = document.getElementById('theme-preview');
                
                try {
                    const theme = window.getTheme();
                    
                    if (!theme || !theme.colors) {
                        throw new Error('Configuration du th√®me manquante');
                    }
                    
                    // V√©rifier les couleurs principales
                    const colors = theme.colors;
                    const requiredColors = ['primary', 'secondary', 'accent'];
                    const missingColors = requiredColors.filter(color => !colors[color]);
                    
                    if (missingColors.length > 0) {
                        throw new Error(`Couleurs manquantes: ${missingColors.join(', ')}`);
                    }
                    
                    // Cr√©er la pr√©visualisation des couleurs
                    preview.innerHTML = `
                        <div class="color-box" style="background-color: ${colors.primary}">
                            Primary<br>${colors.primary}
                        </div>
                        <div class="color-box" style="background-color: ${colors.secondary}">
                            Secondary<br>${colors.secondary}
                        </div>
                        <div class="color-box" style="background-color: ${colors.accent}">
                            Accent<br>${colors.accent}
                        </div>
                    `;
                    
                    result.innerHTML = `
                        <div class="alert alert-success">
                            ‚úÖ <strong>Test r√©ussi!</strong><br>
                            - Th√®me charg√© avec ${Object.keys(theme).length} sections<br>
                            - Couleurs principales disponibles<br>
                            - Polices: ${Object.keys(theme.fonts || {}).length} d√©finies<br>
                            - Espacements: ${Object.keys(theme.spacing || {}).length} d√©finis
                        </div>
                    `;
                    container.classList.add('test-success');
                    testResults.push(true);
                } catch (error) {
                    result.innerHTML = `
                        <div class="alert alert-danger">
                            ‚ùå <strong>Test √©chou√©:</strong><br>
                            ${error.message}
                        </div>
                    `;
                    container.classList.add('test-error');
                    testResults.push(false);
                }
            }

            // Test 3: Fonctions utilitaires
            function test3() {
                console.log('Test 3: Fonctions utilitaires du th√®me');
                const container = document.getElementById('test3');
                const result = document.getElementById('test3-result');
                
                try {
                    // Test getThemeColor
                    const primaryColor = window.getThemeColor('primary');
                    if (!primaryColor) {
                        throw new Error('getThemeColor("primary") retourne null');
                    }
                    
                    // Test getThemeSpacing
                    const mediumSpacing = window.getThemeSpacing('md');
                    if (!mediumSpacing) {
                        throw new Error('getThemeSpacing("md") retourne null');
                    }
                    
                    // Test getThemeFont
                    const primaryFont = window.getThemeFont('primary');
                    if (!primaryFont) {
                        throw new Error('getThemeFont("primary") retourne null');
                    }
                    
                    result.innerHTML = `
                        <div class="alert alert-success">
                            ‚úÖ <strong>Test r√©ussi!</strong><br>
                            - getThemeColor('primary'): <code>${primaryColor}</code><br>
                            - getThemeSpacing('md'): <code>${mediumSpacing}</code><br>
                            - getThemeFont('primary'): <code>${primaryFont}</code>
                        </div>
                    `;
                    container.classList.add('test-success');
                    testResults.push(true);
                } catch (error) {
                    result.innerHTML = `
                        <div class="alert alert-danger">
                            ‚ùå <strong>Test √©chou√©:</strong><br>
                            ${error.message}
                        </div>
                    `;
                    container.classList.add('test-error');
                    testResults.push(false);
                }
            }

            // Test 4: Navigation et langues
            function test4() {
                console.log('Test 4: Navigation et multilangue');
                const container = document.getElementById('test4');
                const result = document.getElementById('test4-result');
                
                try {
                    // Test langue courante
                    const currentLang = window.getCurrentLanguage();
                    if (!currentLang) {
                        throw new Error('getCurrentLanguage() retourne null');
                    }
                    
                    // Test navigation localis√©e
                    const navigation = window.getLocalizedData('navigation');
                    if (!navigation || !Array.isArray(navigation)) {
                        throw new Error('Navigation localis√©e introuvable');
                    }
                    
                    // Test changement de langue
                    const langChanged = window.setCurrentLanguage('en');
                    if (!langChanged) {
                        throw new Error('Impossible de changer la langue vers "en"');
                    }
                    
                    // Remettre la langue originale
                    window.setCurrentLanguage(currentLang);
                    
                    result.innerHTML = `
                        <div class="alert alert-success">
                            ‚úÖ <strong>Test r√©ussi!</strong><br>
                            - Langue courante: <code>${currentLang}</code><br>
                            - Navigation: ${navigation.length} √©l√©ments<br>
                            - Changement de langue: ‚úÖ
                        </div>
                    `;
                    container.classList.add('test-success');
                    testResults.push(true);
                } catch (error) {
                    result.innerHTML = `
                        <div class="alert alert-danger">
                            ‚ùå <strong>Test √©chou√©:</strong><br>
                            ${error.message}
                        </div>
                    `;
                    container.classList.add('test-error');
                    testResults.push(false);
                }
            }

            // Test 5: Donn√©es du site
            function test5() {
                console.log('Test 5: Donn√©es du site');
                const container = document.getElementById('test5');
                const result = document.getElementById('test5-result');
                
                try {
                    const siteData = window.getGlobalData('site');
                    if (!siteData) {
                        throw new Error('Donn√©es du site introuvables');
                    }
                    
                    const services = window.getLocalizedData('services');
                    const projects = window.getLocalizedData('projects');
                    const team = window.getLocalizedData('team');
                    
                    if (!services || !projects || !team) {
                        throw new Error('Donn√©es localis√©es manquantes');
                    }
                    
                    result.innerHTML = `
                        <div class="alert alert-success">
                            ‚úÖ <strong>Test r√©ussi!</strong><br>
                            - Site: <code>${siteData.name}</code><br>
                            - Services: ${services.length} √©l√©ments<br>
                            - Projets: ${projects.length} √©l√©ments<br>
                            - √âquipe: ${team.length} membres
                        </div>
                    `;
                    container.classList.add('test-success');
                    testResults.push(true);
                } catch (error) {
                    result.innerHTML = `
                        <div class="alert alert-danger">
                            ‚ùå <strong>Test √©chou√©:</strong><br>
                            ${error.message}
                        </div>
                    `;
                    container.classList.add('test-error');
                    testResults.push(false);
                }
            }

            // Afficher le r√©sum√©
            function showSummary() {
                const summary = document.getElementById('summary-result');
                const passed = testResults.filter(r => r).length;
                const total = testResults.length;
                const success = passed === total;
                
                summary.innerHTML = `
                    <div class="alert alert-${success ? 'success' : 'warning'} text-center">
                        <h4>${success ? 'üéâ' : '‚ö†Ô∏è'} Tests termin√©s</h4>
                        <p class="h5">${passed}/${total} tests r√©ussis</p>
                        ${success ? 
                            '<p><strong>‚úÖ Syst√®me de th√®me global enti√®rement fonctionnel!</strong></p>' :
                            '<p><strong>‚ö†Ô∏è Certains tests ont √©chou√©. V√©rifiez les d√©tails ci-dessus.</strong></p>'
                        }
                    </div>
                `;
                
                const summaryContainer = document.getElementById('summary');
                summaryContainer.classList.add(success ? 'test-success' : 'test-error');
                
                console.log(`üèÅ Tests termin√©s: ${passed}/${total} r√©ussis`);
            }

            // Ex√©cuter tous les tests
            setTimeout(() => {
                test1();
                setTimeout(() => {
                    test2();
                    setTimeout(() => {
                        test3();
                        setTimeout(() => {
                            test4();
                            setTimeout(() => {
                                test5();
                                setTimeout(showSummary, 500);
                            }, 500);
                        }, 500);
                    }, 500);
                }, 500);
            }, 1000);
        });
    </script>
</body>
</html>
