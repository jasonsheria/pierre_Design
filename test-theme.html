<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test du Syst√®me de Th√®me Global</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f8f9fa;
        }
        .test-container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .test-button {
            background: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .test-results {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin-top: 15px;
            border-left: 4px solid #007bff;
        }
        .color-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .color-item {
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            font-weight: bold;
            color: white;
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
        }
        .theme-demo {
            margin-top: 20px;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #dee2e6;
        }
        .font-sample {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
            background: #f8f9fa;
        }
        .spacing-demo {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        .spacing-item {
            background: #007bff;
            color: white;
            text-align: center;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }
        .success { color: #28a745; }
        .error { color: #dc3545; }
        .warning { color: #ffc107; }
        .info { color: #17a2b8; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üé® Test du Syst√®me de Th√®me Global</h1>
        <p>Cette page teste et d√©montre le syst√®me de th√®me global int√©gr√©.</p>
        
        <div>
            <h3>Tests de Base</h3>
            <button class="test-button" onclick="testThemeAccess()">üîç Test Acc√®s Th√®me</button>
            <button class="test-button" onclick="showColorPalette()">üé® Palette de Couleurs</button>
            <button class="test-button" onclick="showFontSamples()">üî§ Exemples de Polices</button>
            <button class="test-button" onclick="showSpacingDemo()">üìê D√©monstration Espacement</button>
        </div>
        
        <div>
            <h3>Tests Avanc√©s</h3>
            <button class="test-button" onclick="generateDynamicCSS()">üìù G√©n√©rer CSS Dynamique</button>
            <button class="test-button" onclick="injectThemeCSS()">üíâ Injecter CSS Th√®me</button>
            <button class="test-button" onclick="testThemeUpdate()">üîÑ Test Mise √† Jour Th√®me</button>
            <button class="test-button" onclick="runDiagnostic()">üîç Diagnostic Complet</button>
        </div>
        
        <div>
            <h3>Exemples Pratiques</h3>
            <button class="test-button" onclick="demonstrateTheme()">üé≠ D√©monstration Compl√®te</button>
            <button class="test-button" onclick="testThemedComponents()">üß© Test Composants</button>
            <button class="test-button" onclick="testNotifications()">üîî Test Notifications</button>
            <button class="test-button" onclick="showGalleryExample()">üñºÔ∏è Exemple Galerie</button>
        </div>
        
        <div class="test-results" id="test-results">
            <strong>R√©sultats des tests :</strong>
            <div id="results-content">Cliquez sur un bouton pour commencer les tests...</div>
        </div>
        
        <div class="theme-demo" id="theme-demo" style="display: none;">
            <h3>üìã D√©monstration du Th√®me</h3>
            <div id="demo-content"></div>
        </div>
    </div>

    <!-- √âl√©ments de test pour application du th√®me -->
    <div class="test-container" id="style-test-container">
        <h2>üß™ Zone de Test d'Application de Styles</h2>
        <p class="test-text">Ce texte peut √™tre styl√© dynamiquement avec le th√®me.</p>
        <button class="theme-test-button">Bouton de Test</button>
        <div class="test-card">
            <h4>Carte de Test</h4>
            <p>Cette carte peut √™tre styl√©e avec les couleurs du th√®me.</p>
        </div>
    </div>

    <!-- Scripts n√©cessaires -->
    <script src="js/globalData.js"></script>
    <script src="js/theme-examples.js"></script>
    
    <script>
        const resultsContent = document.getElementById('results-content');
        const themeDemo = document.getElementById('theme-demo');
        const demoContent = document.getElementById('demo-content');
        
        function addToResults(message, type = 'info') {
            const className = type === 'success' ? 'success' : type === 'error' ? 'error' : type === 'warning' ? 'warning' : 'info';
            resultsContent.innerHTML += `<div class="${className}">‚úì ${message}</div>`;
        }
        
        function clearResults() {
            resultsContent.innerHTML = '';
        }
        
        function showDemo() {
            themeDemo.style.display = 'block';
        }
        
        function testThemeAccess() {
            clearResults();
            addToResults('üîç Test d\'acc√®s au syst√®me de th√®me...', 'info');
            
            try {
                // Test des fonctions disponibles
                const functions = [
                    'getTheme', 'getThemeColor', 'getThemeSpacing', 'getThemeFont',
                    'applyThemeStyles', 'generateThemeCSS', 'injectThemeCSS', 
                    'updateTheme', 'diagnoseTheme'
                ];
                
                functions.forEach(funcName => {
                    if (typeof window[funcName] === 'function') {
                        addToResults(`Fonction ${funcName} disponible`, 'success');
                    } else {
                        addToResults(`Fonction ${funcName} manquante`, 'error');
                    }
                });
                
                // Test d'acc√®s aux donn√©es
                const theme = window.getTheme();
                if (theme) {
                    addToResults('Th√®me global r√©cup√©r√© avec succ√®s', 'success');
                    addToResults(`${Object.keys(theme.colors).length} couleurs d√©finies`, 'info');
                    addToResults(`${Object.keys(theme.fonts).length} polices d√©finies`, 'info');
                    addToResults(`${Object.keys(theme.spacing).length} espacements d√©finis`, 'info');
                    
                    // Test couleurs sp√©cifiques
                    const primaryColor = window.getThemeColor('primary');
                    if (primaryColor) {
                        addToResults(`Couleur primaire: ${primaryColor}`, 'success');
                    }
                } else {
                    addToResults('Impossible de r√©cup√©rer le th√®me', 'error');
                }
                
            } catch (error) {
                addToResults(`Erreur lors du test: ${error.message}`, 'error');
            }
        }
        
        function showColorPalette() {
            clearResults();
            addToResults('üé® G√©n√©ration de la palette de couleurs...', 'info');
            
            try {
                const theme = window.getTheme();
                if (!theme || !theme.colors) {
                    addToResults('Couleurs du th√®me non disponibles', 'error');
                    return;
                }
                
                let paletteHTML = '<div class="color-grid">';
                Object.entries(theme.colors).forEach(([name, color]) => {
                    // D√©terminer la couleur du texte (noir ou blanc) selon la luminosit√©
                    const textColor = isLightColor(color) ? '#000000' : '#ffffff';
                    paletteHTML += `
                        <div class="color-item" style="background-color: ${color}; color: ${textColor};">
                            <div><strong>${name}</strong></div>
                            <div style="font-size: 12px; opacity: 0.9;">${color}</div>
                        </div>
                    `;
                });
                paletteHTML += '</div>';
                
                demoContent.innerHTML = paletteHTML;
                showDemo();
                addToResults(`Palette g√©n√©r√©e avec ${Object.keys(theme.colors).length} couleurs`, 'success');
                
            } catch (error) {
                addToResults(`Erreur g√©n√©ration palette: ${error.message}`, 'error');
            }
        }
        
        function showFontSamples() {
            clearResults();
            addToResults('üî§ G√©n√©ration des exemples de polices...', 'info');
            
            try {
                const theme = window.getTheme();
                if (!theme || !theme.fonts) {
                    addToResults('Polices du th√®me non disponibles', 'error');
                    return;
                }
                
                let fontHTML = '<h4>Exemples de Polices</h4>';
                Object.entries(theme.fonts).forEach(([name, font]) => {
                    if (typeof font === 'string') {
                        fontHTML += `
                            <div class="font-sample" style="font-family: ${font};">
                                <strong>${name}:</strong> Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                                <br><small style="opacity: 0.7;">Police: ${font}</small>
                            </div>
                        `;
                    }
                });
                
                // Tailles de police
                fontHTML += '<h4>Tailles de Police</h4>';
                Object.entries(theme.fonts.sizes || {}).forEach(([name, size]) => {
                    fontHTML += `
                        <div class="font-sample" style="font-size: ${size};">
                            <strong>${name} (${size}):</strong> Exemple de texte
                        </div>
                    `;
                });
                
                demoContent.innerHTML = fontHTML;
                showDemo();
                addToResults('Exemples de polices g√©n√©r√©s', 'success');
                
            } catch (error) {
                addToResults(`Erreur g√©n√©ration polices: ${error.message}`, 'error');
            }
        }
        
        function showSpacingDemo() {
            clearResults();
            addToResults('üìê G√©n√©ration de la d√©monstration d\'espacement...', 'info');
            
            try {
                const theme = window.getTheme();
                if (!theme || !theme.spacing) {
                    addToResults('Espacements du th√®me non disponibles', 'error');
                    return;
                }
                
                let spacingHTML = '<h4>Valeurs d\'Espacement</h4><div class="spacing-demo">';
                Object.entries(theme.spacing).forEach(([name, value]) => {
                    spacingHTML += `
                        <div class="spacing-item" style="width: ${value}; height: ${value}; min-width: 60px;">
                            ${name}<br><small>${value}</small>
                        </div>
                    `;
                });
                spacingHTML += '</div>';
                
                demoContent.innerHTML = spacingHTML;
                showDemo();
                addToResults(`D√©monstration g√©n√©r√©e avec ${Object.keys(theme.spacing).length} valeurs`, 'success');
                
            } catch (error) {
                addToResults(`Erreur g√©n√©ration espacement: ${error.message}`, 'error');
            }
        }
        
        function generateDynamicCSS() {
            clearResults();
            addToResults('üìù G√©n√©ration du CSS dynamique...', 'info');
            
            try {
                const css = window.generateThemeCSS();
                if (css) {
                    addToResults('CSS dynamique g√©n√©r√© avec succ√®s', 'success');
                    addToResults(`${css.split('\\n').length} lignes de CSS g√©n√©r√©es`, 'info');
                    
                    // Afficher un aper√ßu
                    const preview = css.substring(0, 500) + '...';
                    demoContent.innerHTML = `
                        <h4>Aper√ßu du CSS G√©n√©r√©</h4>
                        <pre style="background: #f8f9fa; padding: 15px; border-radius: 5px; overflow-x: auto; font-size: 12px;">${preview}</pre>
                        <p><strong>Longueur totale:</strong> ${css.length} caract√®res</p>
                    `;
                    showDemo();
                } else {
                    addToResults('Erreur g√©n√©ration CSS', 'error');
                }
                
            } catch (error) {
                addToResults(`Erreur: ${error.message}`, 'error');
            }
        }
        
        function injectThemeCSS() {
            clearResults();
            addToResults('üíâ Injection du CSS du th√®me...', 'info');
            
            try {
                const success = window.injectThemeCSS();
                if (success) {
                    addToResults('CSS du th√®me inject√© avec succ√®s', 'success');
                    addToResults('V√©rifiez l\'√©l√©ment <style> dans le <head>', 'info');
                    
                    // V√©rifier l'injection
                    const injectedStyle = document.getElementById('dynamic-theme-css');
                    if (injectedStyle) {
                        addToResults('√âl√©ment <style> trouv√© dans le DOM', 'success');
                        addToResults(`${injectedStyle.textContent.length} caract√®res de CSS inject√©s`, 'info');
                    }
                } else {
                    addToResults('√âchec de l\'injection CSS', 'error');
                }
                
            } catch (error) {
                addToResults(`Erreur: ${error.message}`, 'error');
            }
        }
        
        function testThemeUpdate() {
            clearResults();
            addToResults('üîÑ Test de mise √† jour du th√®me...', 'info');
            
            try {
                // Sauvegarder la couleur primaire actuelle
                const originalPrimary = window.getThemeColor('primary');
                addToResults(`Couleur primaire actuelle: ${originalPrimary}`, 'info');
                
                // Tester une mise √† jour
                const newThemeData = {
                    colors: {
                        primary: '#ff6b35' // Orange vif
                    }
                };
                
                const success = window.updateTheme(newThemeData);
                if (success) {
                    const newPrimary = window.getThemeColor('primary');
                    addToResults(`Th√®me mis √† jour - nouvelle couleur: ${newPrimary}`, 'success');
                    
                    // Restaurer l'original apr√®s 3 secondes
                    setTimeout(() => {
                        window.updateTheme({ colors: { primary: originalPrimary } });
                        addToResults('Couleur primaire restaur√©e', 'info');
                    }, 3000);
                } else {
                    addToResults('√âchec de la mise √† jour', 'error');
                }
                
            } catch (error) {
                addToResults(`Erreur: ${error.message}`, 'error');
            }
        }
        
        function runDiagnostic() {
            clearResults();
            addToResults('üîç Ex√©cution du diagnostic complet...', 'info');
            
            try {
                const theme = window.diagnoseTheme();
                addToResults('Diagnostic ex√©cut√© - voir console pour d√©tails', 'success');
                
                if (theme) {
                    addToResults('‚úÖ Syst√®me de th√®me op√©rationnel', 'success');
                } else {
                    addToResults('‚ùå Probl√®mes d√©tect√©s dans le syst√®me de th√®me', 'error');
                }
                
            } catch (error) {
                addToResults(`Erreur diagnostic: ${error.message}`, 'error');
            }
        }
        
        function testThemedComponents() {
            clearResults();
            addToResults('üß© Test des composants avec th√®me...', 'info');
            
            try {
                // Tester la cr√©ation de boutons
                const button = window.createThemedButton('Test Button', 'primary', 'lg');
                if (button && button.includes('background-color')) {
                    addToResults('Bouton th√©matis√© cr√©√© avec succ√®s', 'success');
                } else {
                    addToResults('√âchec cr√©ation bouton', 'error');
                }
                
                // Tester la cr√©ation de cartes
                const card = window.createThemedCard('Test Card', 'Contenu de test', 'accent1');
                if (card && card.includes('border-left')) {
                    addToResults('Carte th√©matis√©e cr√©√©e avec succ√®s', 'success');
                } else {
                    addToResults('√âchec cr√©ation carte', 'error');
                }
                
                // Tester la cr√©ation de formulaires
                const form = window.createThemedForm([
                    { label: 'Test', type: 'text', placeholder: 'Test input' }
                ]);
                if (form && form.includes('form')) {
                    addToResults('Formulaire th√©matis√© cr√©√© avec succ√®s', 'success');
                } else {
                    addToResults('√âchec cr√©ation formulaire', 'error');
                }
                
                // Afficher un exemple
                demoContent.innerHTML = `
                    <h4>Exemples de Composants</h4>
                    <div style="margin: 15px 0;">${button}</div>
                    ${card}
                    <div style="margin-top: 20px;">${form}</div>
                `;
                showDemo();
                
            } catch (error) {
                addToResults(`Erreur test composants: ${error.message}`, 'error');
            }
        }
        
        function testNotifications() {
            clearResults();
            addToResults('üîî Test des notifications th√©matis√©es...', 'info');
            
            try {
                const types = ['success', 'error', 'warning', 'info'];
                types.forEach((type, index) => {
                    setTimeout(() => {
                        window.showThemedNotification(
                            `Notification ${type} test`,
                            type,
                            2000
                        );
                    }, index * 600);
                });
                
                addToResults('4 notifications test lanc√©es', 'success');
                addToResults('Les notifications apparaissent en haut √† droite', 'info');
                
            } catch (error) {
                addToResults(`Erreur test notifications: ${error.message}`, 'error');
            }
        }
        
        function showGalleryExample() {
            clearResults();
            addToResults('üñºÔ∏è G√©n√©ration d\'exemple de galerie...', 'info');
            
            try {
                const sampleImages = [
                    {
                        src: 'images/work-1.jpg',
                        title: 'Projet Web',
                        description: 'Site web moderne et responsive'
                    },
                    {
                        src: 'images/work-2.jpg',
                        title: 'App Mobile',
                        description: 'Application mobile native'
                    },
                    {
                        src: 'images/work-3.jpg',
                        title: 'Branding',
                        description: 'Identit√© visuelle compl√®te'
                    },
                    {
                        src: 'images/work-4.jpg',
                        title: 'E-commerce',
                        description: 'Boutique en ligne'
                    }
                ];
                
                const gallery = window.createThemedGallery(sampleImages);
                if (gallery) {
                    demoContent.innerHTML = `
                        <h4>Galerie Th√©matis√©e</h4>
                        ${gallery}
                    `;
                    showDemo();
                    addToResults('Galerie g√©n√©r√©e avec succ√®s', 'success');
                    addToResults('Cliquez sur les images pour tester les interactions', 'info');
                } else {
                    addToResults('√âchec g√©n√©ration galerie', 'error');
                }
                
            } catch (error) {
                addToResults(`Erreur galerie: ${error.message}`, 'error');
            }
        }
        
        // Fonction utilitaire pour d√©terminer si une couleur est claire
        function isLightColor(color) {
            const hex = color.replace('#', '');
            const r = parseInt(hex.substr(0, 2), 16);
            const g = parseInt(hex.substr(2, 2), 16);
            const b = parseInt(hex.substr(4, 2), 16);
            const brightness = ((r * 299) + (g * 587) + (b * 114)) / 1000;
            return brightness > 128;
        }
        
        // Auto-test au chargement
        window.addEventListener('load', function() {
            setTimeout(() => {
                addToResults('Page de test du th√®me charg√©e et pr√™te', 'success');
                console.log('=== PAGE DE TEST DU TH√àME PR√äTE ===');
                
                // Test automatique d'acc√®s
                if (typeof window.getTheme === 'function') {
                    addToResults('Fonctions de th√®me d√©tect√©es', 'success');
                } else {
                    addToResults('Fonctions de th√®me non d√©tect√©es', 'warning');
                }
            }, 1000);
        });
    </script>
</body>
</html>
